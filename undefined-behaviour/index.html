<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>What is 'Undefined Behaviour'? | C & C++ FAQ</title><meta name=keywords content="beginner"><meta name=description content="Undefined Behaviour (also known as UB) occurs when you violate certain language rules. These rules include (but are not limited to): dereferencing a null pointer, signed integer overflow, accessing through a dangling reference, or accessing through an unaligned pointer.
When undefined behaviour occurs, the C and C++ standards do not place any restrictions on what your program might do. In other words, your program may crash, or continue execution, or call some seemingly unrelated piece of code, or print 42 and open xkcd in your web browser."><meta name=author content><link rel=canonical href=https://64.github.io/cpp-faq/undefined-behaviour/><link href=/cpp-faq/assets/css/stylesheet.min.642e2a0657439d758aca2aedf3ef6ad1415d2d970562c281dd262c6aad4686b1.css integrity="sha256-ZC4qBldDnXWKyirt8+9q0UFdLZcFYsKB3SYsaq1GhrE=" rel="preload stylesheet" as=style><link rel=icon href=https://64.github.io/cpp-faq/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://64.github.io/cpp-faq/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://64.github.io/cpp-faq/favicon-32x32.png><link rel=apple-touch-icon href=https://64.github.io/cpp-faq/apple-touch-icon.png><link rel=mask-icon href=https://64.github.io/cpp-faq/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><meta property="og:title" content="What is 'Undefined Behaviour'?"><meta property="og:description" content="Undefined Behaviour (also known as UB) occurs when you violate certain language rules. These rules include (but are not limited to): dereferencing a null pointer, signed integer overflow, accessing through a dangling reference, or accessing through an unaligned pointer.
When undefined behaviour occurs, the C and C++ standards do not place any restrictions on what your program might do. In other words, your program may crash, or continue execution, or call some seemingly unrelated piece of code, or print 42 and open xkcd in your web browser."><meta property="og:type" content="article"><meta property="og:url" content="https://64.github.io/cpp-faq/undefined-behaviour/"><meta property="og:site_name" content="C & C++ FAQ"><meta name=twitter:card content="summary"><meta name=twitter:title content="What is 'Undefined Behaviour'?"><meta name=twitter:description content="Undefined Behaviour (also known as UB) occurs when you violate certain language rules. These rules include (but are not limited to): dereferencing a null pointer, signed integer overflow, accessing through a dangling reference, or accessing through an unaligned pointer.
When undefined behaviour occurs, the C and C++ standards do not place any restrictions on what your program might do. In other words, your program may crash, or continue execution, or call some seemingly unrelated piece of code, or print 42 and open xkcd in your web browser."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Faqs","item":"https://64.github.io/cpp-faq/faq/"},{"@type":"ListItem","position":3,"name":"What is 'Undefined Behaviour'?","item":"https://64.github.io/cpp-faq/undefined-behaviour/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"What is 'Undefined Behaviour'?","name":"What is \u0027Undefined Behaviour\u0027?","description":"Undefined Behaviour (also known as UB) occurs when you violate certain language rules. These rules include (but are not limited to): dereferencing a null pointer, signed integer …","keywords":["beginner"],"articleBody":"Undefined Behaviour (also known as UB) occurs when you violate certain language rules. These rules include (but are not limited to): dereferencing a null pointer, signed integer overflow, accessing through a dangling reference, or accessing through an unaligned pointer.\nWhen undefined behaviour occurs, the C and C++ standards do not place any restrictions on what your program might do. In other words, your program may crash, or continue execution, or call some seemingly unrelated piece of code, or print 42 and open xkcd in your web browser. In practice, you may be able to reason about how your compiler will respond to UB, and in some cases compilers will guarantee that certain operations are well-defined, but for maximum portability you should aim to keep your programs UB-free.\nExamples of UB int x; std::cout  x; // UB: x was used before being initialized  int *y = nullptr; *y = 5; // UB: dereferencing null pointer  int arrayA[10]; for(int z : arrayA) std::cout  x  ' '; // UB: array elements used when uninitialized  int *w = new int; delete w; *w = 5; // UB: object used after being destroyed Avoiding UB Undefined behaviour can be difficult to diagnose. Always compile with warnings enabled, but note that compilers can’t detect all problems at compile time. Tools like ASan, UBSan and Valgrind perform checks on your code at runtime and are good at catching invalid memory accesses, so are recommended for use during development.\nFor gcc and clang users, we recommend using -Wall -Wextra -g -fsanitize=address,undefined in your compilation flags during development. This enables compiler warnings, ASan, UBSan (and debugging symbols for nicer sanitizer error messages).\nSee Also  https://en.cppreference.com/w/c/language/behavior  ","wordCount":"279","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://64.github.io/cpp-faq/undefined-behaviour/"},"publisher":{"@type":"Organization","name":"C \u0026 C++ FAQ","logo":{"@type":"ImageObject","url":"https://64.github.io/cpp-faq/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://64.github.io/cpp-faq accesskey=h title="C & C++ FAQ (Alt + H)">C & C++ FAQ</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>What is &lsquo;Undefined Behaviour&rsquo;?</h1><div class=post-meta><ul class=post-tags><li><a href=https://64.github.io/cpp-faq/tags/beginner/>beginner</a></li></ul></div></header><div class=post-content><p>Undefined Behaviour (also known as <strong>UB</strong>) occurs when you violate certain language rules. These rules include (but are not limited to): dereferencing a null pointer, signed integer overflow, accessing through a <a href=https://en.cppreference.com/w/cpp/language/reference#Dangling_references>dangling reference</a>, or accessing through an unaligned pointer.</p><p><strong>When undefined behaviour occurs, the C and C++ standards do not place any restrictions on what your program might do.</strong> In other words, your program may crash, or continue execution, or call some seemingly unrelated piece of code, or print 42 and open <a href=https://xkcd.com/>xkcd</a> in your web browser. In practice, you <em>may</em> be able to reason about how your compiler will respond to UB, and in some cases compilers will guarantee that certain operations are well-defined, but for maximum portability you should aim to keep your programs UB-free.</p><h2 id=examples-of-ub>Examples of UB<a hidden class=anchor aria-hidden=true href=#examples-of-ub>#</a></h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>int</span> x;
std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> x; <span style=color:#75715e>// UB: x was used before being initialized
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>y <span style=color:#f92672>=</span> <span style=color:#66d9ef>nullptr</span>;
<span style=color:#f92672>*</span>y <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>; <span style=color:#75715e>// UB: dereferencing null pointer
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>int</span> arrayA[<span style=color:#ae81ff>10</span>];
<span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> z : arrayA)
    std<span style=color:#f92672>::</span>cout <span style=color:#f92672>&lt;&lt;</span> x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39; &#39;</span>; <span style=color:#75715e>// UB: array elements used when uninitialized
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>w <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span>;
<span style=color:#66d9ef>delete</span> w;
<span style=color:#f92672>*</span>w <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>; <span style=color:#75715e>// UB: object used after being destroyed
</span></code></pre></div><h2 id=avoiding-ub>Avoiding UB<a hidden class=anchor aria-hidden=true href=#avoiding-ub>#</a></h2><p>Undefined behaviour can be difficult to diagnose. Always <a href=https://64.github.io/cpp-faq/enable-warnings/>compile with warnings enabled</a>, but note that compilers can&rsquo;t detect all problems at compile time. Tools like <a href=https://en.wikipedia.org/wiki/AddressSanitizer>ASan</a>, <a href=https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html>UBSan</a> and <a href=https://valgrind.org/docs/manual/quick-start.html#quick-start.mcrun>Valgrind</a> perform checks on your code at runtime and are good at catching invalid memory accesses, so are recommended for use during development.</p><p>For <code>gcc</code> and <code>clang</code> users, we recommend using <code>-Wall -Wextra -g -fsanitize=address,undefined</code> in your compilation flags during development. This enables compiler warnings, ASan, UBSan (and debugging symbols for nicer sanitizer error messages).</p><h3 id=see-also>See Also<a hidden class=anchor aria-hidden=true href=#see-also>#</a></h3><ul><li><a href=https://en.cppreference.com/w/c/language/behavior>https://en.cppreference.com/w/c/language/behavior</a></li></ul></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://64.github.io/cpp-faq>C & C++ FAQ</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/cpp-faq/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>